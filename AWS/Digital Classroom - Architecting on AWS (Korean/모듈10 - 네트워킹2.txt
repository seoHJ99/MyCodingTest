-----------------------------
vpc 엔드포인트

기존 nat 게이트웨이를 사용하는 방식은 병목현상과 보안, nat 게이트웨이 사용 비용 문제가 존재
따라서 vpc 나 aws 의 다른 서비스와 통신은 vcp 엔드포인트를 사용.

vpc :aws 서비스와 통신할수 있도록 연결된 네트워크 환경
vpc 엔드포이트 : ip주소 또는 nat를 사용하지 않고 aws 서비스에 액세스 하기 위한 기술
    - 게이트웨이 엔드포인트와 인터페이스 엔드포인트로 나뉨

게이트웨이 엔드포인트
    - nat을 사용하지 않고 연결
    - 라우팅 테이블에 접두사(프리픽스) 를 구성하면 게이트웨이 엔드포인트를 이용해서 vpc 밖의 서비스와 통신 가능
인트페이스 vpc 엔드포인트
    - 인터페이스 엔드포인트에 연결된 ip 주소가 있음
    - 내부적으로 dns 기능을 가지고 있어 라우팅 그룹을 수정할 필요가 없음
    - 통신에 편리한 디버깅 가능
    - 연결된 보안그룹이 존재
    - 트래픽이 이 새로운 엔드포인트로 전달됨



------------------------------------
VPC 피어링

서로 다른 vpc 간에 연결하는 것.
리전간, 리전내 지원
교차 계정 지원

서로 다른 vpc 간 동의한 이후, 라우팅 테이블에 서로의 피어링 연결을 구성해줘야 함.
이때 ip 공간이 중복되면 안됨.
vpc 다이 피어링 연결 수에는 제한이 있음.
동일한 vpc 간에 여러 피어링 불가능.
피어링 최대 전송 단위(MTU)는 1500바이트

다른 회사의 어플이나 우회 등을 하려고 할때 사용 가능.
병목 현상이 없음.
프리이빗 ip 내부에서 이뤄짐.

전이적 피어링을 제공하지 않음. 즉, 직접적으로 연결된 vpc 가 아니면 통신 불가능
1:1관계.

풀 메시 vpc 피어링
모든 vpc 가 연결된 피어링.
복잡함



----------------------------
하이브리드 네트워킹

1. Site-to-Site VPN
aws 와 자체 데이터센터를 같이 사용하는 방법
연결의 구성 요소
   - 고객 게이트웨이 디바이스
   - 가상 프라이빗 게이트웨이

1. 온 프레미스(고객 디바이스)를 aws 에서 리소스로 생성
2. 가상 프라이빗 게이트웨이를 생성하여 vpc와 연결
3. vpn 을 생성하여 이 둘을 연결

이때 가상 프라이빗 게이트웨이는 항상 2개의 엔드포인트가 존재
유지 보수를 위한 중복성.
구성시간이 빠름.
암호화 되어 퍼블릭 인터넷망을 사용.
    -  시간당 요금
    - 데이터 통신(DTO). 기가바이트 단위로 측정

2. Direct Connect
물리적인 독립망을 이용하여 연결.
1. Direct Connect 로케이션을 vpc 에 연결 
2. 로컬에서 Direct Connect 로케이션에 연결

암호화되지 안음
전용망 사용.
구성시간이 걸림
    - 용량단위에 대해 요금
    - 포트시간에 대해 요금
    - 데이터 송신(DTO)


------------------------
AWS Transit Gateway

복잡해진 피어링을 관리하기 위한 서비스
최대 5000개의 vpc 와 온프레미스 환경 연결
Direct Connect 또는 다른 vpc 와 연결 가능
누가 누구와 통신할지 설정 가능
멀티캐스트 및 리전간 피어링을 허용 가능
라우팅 계획을 한곳에서 작성하는 원리
    - 연결기반
    - 라우팅 세분화
    - 간편한 연결
    - 고가용성 및 확장성
vpc, vpn, Direct Connect의 게이트웨이, Transit Gateway 피어링(다른 리전)과 연결 가능
1. vpc 의 통신에 대한 라우팅 테이블을 Transit Gateway 가 관리함
동적 또는 정적 라우팅을 지원
특정 그룹, 환경 격리 가능
Transit Gateway는 여러 AWS 계정에서 작동합니다
AWS Resource Access Manager를 사용하여 Transit Gateway를 다른 계정과 공유할 수 있습니다

